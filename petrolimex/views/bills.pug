extends ./layouts/common

block style
    include ../css/common.css

block content

    button.btn.btn-success.mb-3(type='button', data-toggle='modal', data-target='#modal-form', style='float:right;') 
        h5 Start creating bill

    #modal-form.modal.fade(tabindex='-1', aria-labelledby='exampleModalLabel', aria-hidden='true')
        .modal-dialog.modal-dialog-centered.modal-dialog-scrollable
            form.modal-content(action="/bills", method="POST")
                .modal-header
                    h5#exampleModalLabel.modal-title Modal title
                    button.close(type='button', data-dismiss='modal', aria-label='Close')
                        span(aria-hidden='true') &times;
                .modal-body
                    table.table.table-borderless
                        tr
                            td Driver
                            td
                                input.form-control(type="text", name ="driverID")   
                        tr
                            td Plate
                            td
                                input.form-control(type="text", name ="plate")
                .modal-footer
                    button.cancel.btn.btn-secondary(type='button', data-dismiss='modal') Cancel
                    button.btn.btn-success(type='submit') Continue

    if accept_create 
        #modal-bill.modal.fade.show(tabindex='-1', aria-labelledby='exampleModalLabel', style='display: block;', aria-modal='true', role='dialog')
            .modal-dialog.modal-dialog-centered.modal-dialog-scrollable
                form.modal-content(action="/bills", method="POST")
                    .modal-header
                        h5#exampleModalLabel.modal-title Modal title
                        button.close(type='button', data-dismiss='modal', aria-label='Close')
                            span(aria-hidden='true') &times;
                    .modal-body
                        div(style="display: none;")
                            input.form-control(type="text", name ="clientID", readonly, value= driver_plate.driver.clientID)
                            input.form-control(type="text", name ="driverID", readonly, value= driver_plate.driver.driverID)
                        table.table.table-borderless
                            tr
                                td Driver
                                td
                                    input.form-control(type="text", readonly, value= driver_plate.driver.name)
                            tr
                                td Plate
                                td
                                    input.form-control(type="text", name ="plate", readonly, value= driver_plate.transport.plate)
                            tr
                                td Subcontract
                                td.form-group
                                    select.form-control(name='subcontractID')
                                        each contractDriver in driver_plate.contractDrivers
                                            option(value=contractDriver.subcontract.subcontractID)= contractDriver.subcontract.name
                            tr
                                td Gas Station
                                td.form-group
                                    select.form-control(name='gasStationID')
                                        each gasStation in gasStations
                                            option(value=gasStation.gasStationID)= gasStation.name
                            tr
                                td Product
                                td.form-group
                                    select.form-control(name='productID')
                                        each product in products
                                            option(value=product.productID)= product.name
                            tr
                                td Quantity
                                td
                                    input.form-control(type="number", name ="quantity", value=0, min=1, max=driver_plate.transport.maxQuantity)
                            tr
                                td Transaction date
                                td
                                    input.form-control(type="datetime-local", name ="transactionDate")
                            tr
                                td Status
                                td.form-group
                                    select.form-control(name='status')
                                        option(value='active') Active
                                        option(value='inactive') Inactive
                    .modal-footer
                        button.cancel.btn.btn-secondary(type='button', data-dismiss='modal') Cancel
                        button.btn.btn-success(type='submit', name='submited', value='true') Create


    table.table.table-striped.table-bordered.table-light
        tr
            th Driver
            th Plate
            th Client
            th Subcontract
            th Gas station
            th Product
            th Quantity
            th Total
            th Transaction Date
            th Status
        if bills.length !== 0
            each bill in bills
                tr
                    td= bill.driver.name
                    td= bill.plate
                    td= bill.client.name
                    td= bill.subcontract.name
                    td= bill.gasStation.name
                    td= bill.product.name
                    td= bill.quantity
                    td= bill.total
                    td= bill.transactionDate
                    td= bill.status

    

block body_continue
    script(type='text/javascript').
        $(document).ready(function() {
            if(!{accept_create}) {
                $('body').append('<div id="close" class="modal-backdrop fade show"></div>');
                $('body').addClass("modal-open");
            }
            $(document).on('click', "button.close, button.cancel, #close", function() {
                $('#modal-bill').remove();
                $('#close').remove();
                $('body').removeClass("modal-open");
            });

        });
